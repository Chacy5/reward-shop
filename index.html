<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Reward Shop</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat+Alternates:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      font-family: 'Montserrat Alternates', sans-serif;
      margin: 0;
      padding: 20px;
      background: #eafff8;
      color: #333;
      padding-bottom: 70px; /* –î–ª—è –Ω–∏–∂–Ω–µ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ */
    }
    h1, h2 {
      color: #065f54;
    }
    .section {
      background: #ffffff;
      padding: 16px;
      border-radius: 16px;
      margin-bottom: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    }
    .counter {
      font-size: 1.5rem;
      font-weight: bold;
      text-align: center;
      background: #b2fff0;
      padding: 20px;
      border-radius: 16px;
      margin-bottom: 20px;
    }
    input, button, select {
      font-size: 1rem;
      padding: 10px;
      margin: 6px 0;
      border: 1px solid #ccc;
      border-radius: 12px;
      width: 100%;
    }
    button {
      background: #6fedd1;
      color: #fff;
      font-weight: bold;
      border: none;
      cursor: pointer;
      transition: transform 0.1s, background-color 0.2s;
    }
    button:active {
      transform: scale(0.97);
      background-color: #57e1c0;
    }
    .card {
      background: #f0fffa;
      border-left: 6px solid #6fedd1;
      border-radius: 10px;
      padding: 12px;
      margin: 10px 0;
      opacity: 0;
      transform: translateY(10px);
      animation: fadeInUp 0.4s ease forwards;
    }
    .card.daily {
      border-left-color: #6fedd1;
    }
    .card.weekly {
      border-left-color: #fdd36a;
    }
    .card.event {
      border-left-color: #ff9edb;
    }
    .desc {
      font-size: 0.9rem;
      color: #555;
      margin-top: 4px;
    }
    .flex {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }
    nav a {
      flex: 1;
      text-align: center;
      padding: 10px;
      text-decoration: none;
      color: #065f54;
      font-weight: bold;
    }
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: #ffffff;
      border-top: 1px solid #ccc;
      display: flex;
      justify-content: space-around;
      z-index: 1000;
    }
    .bottom-nav a.active {
      background: #e0fff8;
      border-top: 3px solid #6fedd1;
    }
    html {
      scroll-behavior: smooth;
    }
    .loader {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(255,255,255,0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      font-size: 1.2rem;
      font-weight: bold;
      color: #065f54;
    }
  </style>
</head>
<body>
  <div class="loader" id="loader">–ó–∞–≥—Ä—É–∑–∫–∞...</div>

  <nav class="bottom-nav">
    <a href="#main" id="nav-main" class="active">üè† –ì–ª–∞–≤–Ω–∞—è</a>
    <a href="#rewardList" id="nav-reward">üè™ –ú–∞–≥–∞–∑–∏–Ω</a>
    <a href="#completed" id="nav-completed">‚úÖ –ó–∞–¥–∞–Ω–∏—è</a>
    <a href="#claimed" id="nav-claimed">üéâ –ù–∞–≥—Ä–∞–¥—ã</a>
  </nav>

  <div class="counter">
    –õ–∞–ø–∫–∏: <span id="points">0</span>
  </div>

  <div id="main" class="section">
    <h2>üìù –ù–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ</h2>
    <select id="questType">
      <option value="daily">–ï–∂–µ–¥–Ω–µ–≤–Ω–æ–µ</option>
      <option value="weekly">–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ–µ</option>
      <option value="event">–°–æ–±—ã—Ç–∏–µ</option>
    </select>
    <input type="text" id="taskName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ" />
    <input type="text" id="taskDesc" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ" />
    <input type="number" id="taskPoints" placeholder="–ù–∞–≥—Ä–∞–¥–∞ (–ª–∞–ø–∫–∏)" />
    <button onclick="addTask()">–î–æ–±–∞–≤–∏—Ç—å</button>

    <h2 style="margin-top:30px;">üìã –ó–∞–¥–∞–Ω–∏—è</h2>
    <div id="questLists"></div>

    <h2 style="margin-top:30px;">üéÅ –ù–æ–≤–∞—è –Ω–∞–≥—Ä–∞–¥–∞</h2>
    <input type="text" id="rewardName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –Ω–∞–≥—Ä–∞–¥—ã" />
    <input type="text" id="rewardDesc" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ" />
    <input type="number" id="rewardCost" placeholder="–°—Ç–æ–∏–º–æ—Å—Ç—å (–ª–∞–ø–∫–∏)" />
    <button onclick="addReward()">–î–æ–±–∞–≤–∏—Ç—å</button>

    <h2 style="margin-top:30px;">üè™ –ú–∞–≥–∞–∑–∏–Ω –Ω–∞–≥—Ä–∞–¥</h2>
    <div id="rewardList"></div>
  </div>

  <div class="section" id="completed">
    <h2>‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è</h2>
    <div id="completedList"></div>
  </div>

  <div class="section" id="claimed">
    <h2>üéâ –ü—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–Ω—ã–µ –Ω–∞–≥—Ä–∞–¥—ã</h2>
    <div id="claimedList"></div>
  </div>

<script>
  let points = parseInt(localStorage.getItem('pawPoints') || '0');
  let quests = JSON.parse(localStorage.getItem('pawQuests') || '[]');
  let completed = JSON.parse(localStorage.getItem('pawCompleted') || '[]');
  let rewards = JSON.parse(localStorage.getItem('pawRewards') || '[]');
  let claimed = JSON.parse(localStorage.getItem('pawClaimed') || '[]');

  function saveAll() {
    localStorage.setItem('pawPoints', points);
    localStorage.setItem('pawQuests', JSON.stringify(quests));
    localStorage.setItem('pawCompleted', JSON.stringify(completed));
    localStorage.setItem('pawRewards', JSON.stringify(rewards));
    localStorage.setItem('pawClaimed', JSON.stringify(claimed));
  }

  function updatePoints() {
    document.getElementById('points').innerText = points;
    saveAll();
  }

  // –ê–≤—Ç–æ-—Å–±—Ä–æ—Å –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –∏ –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π –ø–æ –¥–∞—Ç–µ
  function autoResetTasks() {
    const today = new Date().toDateString();
    const lastReset = localStorage.getItem('pawResetDate');
    if (lastReset === today) return;
    quests = quests.filter(q => q.type !== 'daily' && q.type !== 'weekly');
    localStorage.setItem('pawResetDate', today);
    saveAll();
    renderQuests();
  }

  function addTask() {
    const type = document.getElementById('questType').value;
    const name = document.getElementById('taskName').value.trim();
    const desc = document.getElementById('taskDesc').value.trim();
    const pts = parseInt(document.getElementById('taskPoints').value);
    if (!name || isNaN(pts) || pts <= 0) {
      alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∑–∞–¥–∞–Ω–∏—è.');
      return;
    }

    const createdAt = new Date().toISOString();
    quests.push({ type, name, desc, pts, createdAt });
    clearTaskInputs();
    renderQuests();
  }

  function clearTaskInputs() {
    document.getElementById('taskName').value = '';
    document.getElementById('taskDesc').value = '';
    document.getElementById('taskPoints').value = '';
  }

  function completeTask(index) {
    if (index < 0 || index >= quests.length) return;
    points += quests[index].pts;
    completed.push({ ...quests[index], doneAt: new Date().toISOString() });
    quests.splice(index, 1);
    updatePoints();
    renderQuests();
    renderCompleted();
  }

  function deleteTask(index) {
    if (index < 0 || index >= quests.length) return;
    if (confirm('–£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ?')) {
      quests.splice(index, 1);
      renderQuests();
    }
  }

  function renderQuests() {
    const container = document.getElementById('questLists');
    container.innerHTML = '';

    const grouped = { daily: [], weekly: [], event: [] };
    quests.forEach((q, i) => grouped[q.type].push({ ...q, index: i }));

    for (const type of ['daily', 'weekly', 'event']) {
      if (grouped[type].length === 0) continue;
      const section = document.createElement('div');
      section.innerHTML = `<h3>${type === 'daily' ? '–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ' : type === 'weekly' ? '–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ' : '–°–æ–±—ã—Ç–∏—è'}</h3>`;
      grouped[type].forEach(q => {
        const card = document.createElement('div');
        card.className = `card ${type}`;
        card.innerHTML = `
          <div class="flex">
            <div>
              <strong>${q.name}</strong>
              <div class="desc">${q.desc}</div>
              <small>–ù–∞–≥—Ä–∞–¥–∞: ${q.pts} –ª–∞–ø–æ–∫</small>
            </div>
            <div style="display:flex; flex-direction: column; gap: 4px;">
              <button onclick="completeTask(${q.index})">‚úî –í—ã–ø–æ–ª–Ω–∏—Ç—å</button>
              <button onclick="deleteTask(${q.index})" style="background:#f66;">üóë</button>
            </div>
          </div>`;
        section.appendChild(card);
      });
      container.appendChild(section);
    }
    saveAll();
  }

  // Rewards
  function addReward() {
    const name = document.getElementById('rewardName').value.trim();
    const desc = document.getElementById('rewardDesc').value.trim();
    const cost = parseInt(document.getElementById('rewardCost').value);
    if (!name || isNaN(cost) || cost <= 0) {
      alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –Ω–∞–≥—Ä–∞–¥—ã');
      return;
    }
    rewards.push({ name, desc, cost });
    clearRewardInputs();
    renderRewards();
  }

  function clearRewardInputs() {
    document.getElementById('rewardName').value = '';
    document.getElementById('rewardDesc').value = '';
    document.getElementById('rewardCost').value = '';
  }

  function claimReward(index) {
    if (index < 0 || index >= rewards.length) return;
    const r = rewards[index];
    if (points < r.cost) {
      alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∞–ø–æ–∫!');
      return;
    }
    points -= r.cost;
    claimed.push({ ...r, claimedAt: new Date().toISOString(), done: false });
    updatePoints();
    renderRewards();
    renderClaimed();
  }

  function deleteReward(index) {
    if (index < 0 || index >= rewards.length) return;
    if (confirm('–£–¥–∞–ª–∏—Ç—å –Ω–∞–≥—Ä–∞–¥—É?')) {
      rewards.splice(index, 1);
      renderRewards();
    }
  }

  function renderRewards() {
    const list = document.getElementById('rewardList');
    list.innerHTML = '';
    rewards.forEach((r, i) => {
      const card = document.createElement('div');
      card.className = 'card';
      card.innerHTML = `
        <div class="flex">
          <div>
            <strong>${r.name}</strong>
            <div class="desc">${r.desc}</div>
          </div>
          <div style="display:flex; flex-direction: column; gap: 6px; min-width: 100px;">
            <button onclick="claimReward(${i})" ${points < r.cost ? 'disabled' : ''}>-${r.cost} üêæ</button>
            <button onclick="deleteReward(${i})" style="background:#f66;">üóë</button>
          </div>
        </div>`;
      list.appendChild(card);
    });
    saveAll();
  }

  // Completed tasks
  function renderCompleted() {
    const list = document.getElementById('completedList');
    list.innerHTML = completed.length ? completed.map((q, i) => `
      <div class="card ${q.type}">
        <strong>${q.name}</strong> <small>(–í—ã–ø–æ–ª–Ω–µ–Ω–æ ${new Date(q.doneAt).toLocaleDateString()})</small>
        <div class="desc">${q.desc}</div>
      </div>
    `).join('') : '<p>–ü–æ–∫–∞ –Ω–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π</p>';
  }

  // Claimed rewards
  function markRewardDone(index) {
    if (index < 0 || index >= claimed.length) return;
    claimed[index].done = true;
    renderClaimed();
  }

  function renderClaimed() {
    const list = document.getElementById('claimedList');
    if (!claimed.length) {
      list.innerHTML = '<p>–ü–æ–∫–∞ –Ω–µ—Ç –ø—Ä–∏–æ–±—Ä–µ—Ç—ë–Ω–Ω—ã—Ö –Ω–∞–≥—Ä–∞–¥</p>';
      return;
    }
    list.innerHTML = claimed.map((r, i) => `
      <div class="card">
        <div class="flex">
          <div>
            <strong>${r.name}</strong>
            <div class="desc">${r.desc}<br>
              <small>–ü—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–æ: ${new Date(r.claimedAt).toLocaleDateString()}</small>
            </div>
          </div>
          <div>
            <button onclick="markRewardDone(${i})" ${r.done ? 'disabled' : ''}>${r.done ? '–í—ã–ø–æ–ª–Ω–µ–Ω–æ' : '–û—Ç–º–µ—Ç–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º'}</button>
          </div>
        </div>
      </div>
    `).join('');
    saveAll();
  }

  // –ù–∞–≤–∏–≥–∞—Ü–∏—è –∏ –ø–ª–∞–≤–Ω—ã–π —Å–∫—Ä–æ–ª–ª + –ø–æ–¥—Å–≤–µ—Ç–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞
  const navLinks = document.querySelectorAll('.bottom-nav a');
  navLinks.forEach(link => {
    link.addEventListener('click', () => {
      navLinks.forEach(l => l.classList.remove('active'));
      link.classList.add('active');
    });
  });

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
  function init() {
    autoResetTasks();
    updatePoints();
    renderQuests();
    renderCompleted();
    renderRewards();
    renderClaimed();
    document.getElementById('loader').style.display = 'none';
  }

  window.onload = init;

</script>
</body>
</html>
